%!TEX root = SysSpec_ClockPendulumAnalyzer.tex
\subsection{Umsetzung der Datenpersistenz}
    Hier stehen Details zur Umsetzung der Datenspeicherung auf dem Raspberry Pi.
    \subsubsection{Datenspeicher}
    Da das Operationssystem des Raspberry Pi auf einer SD Karte gespeichert ist, empfiehlt es sich eine Alternative zu finden. SD Karten sind nicht für häufige Schreibzyklen ausgelegt. Für den Clock Pendulum Analyzer wird deshalb ein USB Speicher verwendet. Auf diesem wird die ganze Datenbank abgelegt.\\
    Der Datenspeicher wird beim Autostart über die \textit{/etc/fstab} Datei automatisch eingebunden.
    
    \subsubsection{SQLite als Datenbank}
    C++ bietet eine grosszügige Schnittstelle für SQLite Datenbanken. Durch SQLite braucht die Applikation auch keine umständliche Datenbankinstallation wie es bei MySQL der Fall wäre, da SQLite nur normale Dateien zum Aufbau verwendet.
    
    \subsubsection{Architektur und Beispielverwendung}
    Die Software speichert die folgenden Daten in einer einzelnen Tabelle ab.
    \paragraph{clock}
    Der Wert in \textit{clock} hält den Namen fest der Uhr, von der die weiteren Daten stammen. Dieser wird beim Programmstart mitgeteilt.\\
    Das Feld ist vom Typ TEXT und besteht aus alphanumerischen Zeichen die der Regular Expression $$[a-zA-Z0-9]\{1,\}$$
    \paragraph{date}\label{sec:db_date}%TODO datumsformat anpassen +zeit
    In diesem Feld steht der Zeitpunkt zu welchem der Datenwert entnommen wurde. Dazu wird die Systemzeit des RPi3 gespeichert und anschliessend so konvertiert, dass der Zeitstempel im Format \textbf{yyyyMMdd} gespeichert werden kann\\
    Das Feld ist vom Typ INTEGER und entspricht der Regular Expression
    $$[0-9]\{8\}$$
    \paragraph{absolutetime}
    Hier steht der aktuell gemessene Zeitwert in absoluter Zeit. Der Wert bezieht sich auf die aktuell vergangenen Nanosekunden in einem Tag. Er startet bei 0:00 und läuft einen Tag.\\
    Das Feld ist vom Typ INTEGER und entspricht der Regular Expression
    $$[0-9]\{1,15\}$$
    \paragraph{heat}
    Das Feld heat wird für den optionalen Teil Temperatureinfluss benötigt. Zum jetzigen Zeitpunkt ist dieses Feld mit 0 initialisiert.
    Das Feld ist vom Typ INTEGER und entspricht der Regular Expression
    $$[0-9]\{1,2\}$$
    \paragraph{humidity}
    Das Feld humidity wird für den optionalen Teil Feuchtigkeitseinfluss benötigt. Zum jetzigen Zeitpunkt ist dieses Feld mit 0 initialisiert.
    Das Feld ist vom Typ INTEGER und entspricht der Regular Expression
    $$[0-9]\{1,2\}$$
    %TODO beispielverwendung einfügen